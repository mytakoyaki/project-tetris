# Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç§»è¡Œé–‹å§‹ãƒ­ã‚°ï¼ˆ2025-07-02ï¼‰

## ğŸ“‹ **ç§»è¡Œæ–¹é‡å¤‰æ›´**

### **å¤‰æ›´å‰ã®è¨ˆç”»**
- Next.js API Routesã§ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…
- Prisma ORMã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹
- æ®µéšçš„ã«Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ç§»è¡Œ

### **å¤‰æ›´å¾Œã®è¨ˆç”»**
- **æœ€åˆã‹ã‚‰Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’æ§‹ç¯‰**
- Next.jsã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å°‚ç”¨
- æœ€é«˜ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨é–‹ç™ºåŠ¹ç‡ã‚’ä¸¡ç«‹

## ğŸ—‘ï¸ **ä¸è¦ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ä½œæ¥­**

### **å‰Šé™¤ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**
- âœ… `src/app/api/` - Next.js API Routeså…¨ä½“
- âœ… `prisma/` - Prismaã‚¹ã‚­ãƒ¼ãƒãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚·ãƒ¼ãƒ‰
- âœ… `src/app/api-test/` - APIãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸

### **å‰Šé™¤ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«**
- âœ… `src/lib/prisma.ts` - Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š
- âœ… `src/types/api.ts` - APIå‹å®šç¾©
- âœ… `scripts/setup-database.sh` - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### **å‰Šé™¤ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸**
```bash
npm uninstall prisma @prisma/client
npm uninstall @types/jsonwebtoken jsonwebtoken
```

### **æ›´æ–°ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«**
- âœ… `docker-compose.yml` - PrismaåˆæœŸåŒ–SQLå‚ç…§å‰Šé™¤
- âœ… `package.json` - Prismaé–¢é€£ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤
- âœ… `env.example` - Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ

## ğŸ“Š **å‰Šé™¤å‰å¾Œã®æ¯”è¼ƒ**

### **å‰Šé™¤å‰ã®æ§‹é€ **
```
modern-tetris/
â”œâ”€â”€ src/app/api/           # Next.js API Routes
â”‚   â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ users/
â”‚   â”œâ”€â”€ scores/
â”‚   â”œâ”€â”€ achievements/
â”‚   â””â”€â”€ ranking/
â”œâ”€â”€ prisma/                # Prisma ORM
â”‚   â”œâ”€â”€ schema.prisma
â”‚   â”œâ”€â”€ seed.ts
â”‚   â””â”€â”€ init.sql
â”œâ”€â”€ src/lib/prisma.ts      # Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ src/types/api.ts       # APIå‹å®šç¾©
â””â”€â”€ scripts/setup-database.sh
```

### **å‰Šé™¤å¾Œã®æ§‹é€ **
```
modern-tetris/
â”œâ”€â”€ src/app/               # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿
â”œâ”€â”€ docker-compose.yml     # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç’°å¢ƒï¼ˆç¶­æŒï¼‰
â”œâ”€â”€ env.example           # Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ç’°å¢ƒå¤‰æ•°
â””â”€â”€ scripts/deploy.sh     # ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆç¶­æŒï¼‰
```

## ğŸ¯ **æ–°ã—ã„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**

### **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆç¶­æŒï¼‰**
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Next.js 15 (App Router) + React 19 + TypeScript
- **UI**: Material-UI (MUI) + Tailwind CSS
- **çŠ¶æ…‹ç®¡ç†**: Redux Toolkit + RTK Query
- **ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³**: Rust + WebAssembly

### **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆæ–°è¦æ§‹ç¯‰ï¼‰**
- **Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Axum/Actix-web/Poem
- **ORM**: Diesel/SeaORM/sqlx
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL (Docker) + Redis
- **èªè¨¼**: Rust JWTã‚¯ãƒ¬ãƒ¼ãƒˆ + Clerké€£æº
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡**: WebSocketï¼ˆtokio-tungsteniteï¼‰

## ğŸ“‹ **æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆPhase 4Cï¼‰**

### **1. Rustãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ**
```bash
cd ..
cargo new rust-backend
cd rust-backend
```

### **2. ä¾å­˜é–¢ä¿‚è¨­å®š**
```toml
[dependencies]
axum = "0.7"
tokio = { version = "1.0", features = ["full"] }
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
diesel = { version = "2.1", features = ["postgres", "chrono"] }
diesel_migrations = "2.1"
jsonwebtoken = "9.2"
redis = { version = "0.24", features = ["tokio-comp"] }
tower-http = { version = "0.5", features = ["cors"] }
tracing = "0.1"
tracing-subscriber = "0.3"
```

### **3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ **
```
rust-backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs              # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ api/                 # APIãƒ«ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ users.rs
â”‚   â”‚   â”œâ”€â”€ scores.rs
â”‚   â”‚   â”œâ”€â”€ achievements.rs
â”‚   â”‚   â””â”€â”€ auth.rs
â”‚   â”œâ”€â”€ models/              # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ user.rs
â”‚   â”‚   â”œâ”€â”€ score.rs
â”‚   â”‚   â””â”€â”€ achievement.rs
â”‚   â”œâ”€â”€ services/            # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ auth_service.rs
â”‚   â”‚   â””â”€â”€ game_service.rs
â”‚   â”œâ”€â”€ db/                  # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â””â”€â”€ connection.rs
â”‚   â””â”€â”€ config/              # è¨­å®š
â”‚       â”œâ”€â”€ mod.rs
â”‚       â””â”€â”€ app_config.rs
â”œâ”€â”€ migrations/              # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ Cargo.toml
â””â”€â”€ .env
```

## ğŸ”§ **ç’°å¢ƒå¤‰æ•°è¨­å®š**

### **Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨**
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
DATABASE_URL="postgresql://tetris_user:tetris_password@localhost:5432/tetris_dev"
REDIS_URL="redis://localhost:6379"

# èªè¨¼
JWT_SECRET="your-super-secret-jwt-key-change-this-in-production"
CLERK_SECRET_KEY="your-clerk-secret"

# ã‚µãƒ¼ãƒãƒ¼è¨­å®š
RUST_LOG="info"
PORT="8080"

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨
NEXT_PUBLIC_API_URL="http://localhost:8080"
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY="your-clerk-key"
```

## ğŸ“ˆ **æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ**

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**
- **APIå¿œç­”æ™‚é–“**: <50msï¼ˆRustã®é«˜é€Ÿæ€§ï¼‰
- **åŒæ™‚æ¥ç¶šæ•°**: 1000+ï¼ˆWebSocketï¼‰
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: <100MB
- **ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ**: 10000+ req/sec

### **é–‹ç™ºåŠ¹ç‡å‘ä¸Š**
- **å‹å®‰å…¨æ€§**: 100%ï¼ˆRust + TypeScriptï¼‰
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ãƒã‚§ãƒƒã‚¯
- **ãƒ¡ãƒ¢ãƒªå®‰å…¨æ€§**: ã‚¼ãƒ­ã‚³ã‚¹ãƒˆæŠ½è±¡åŒ–
- **ä¸¦è¡Œå‡¦ç†**: å®‰å…¨ãªéåŒæœŸå‡¦ç†

## ğŸ¯ **ç§»è¡Œã®åˆ©ç‚¹**

### **æŠ€è¡“çš„åˆ©ç‚¹**
1. **æœ€é«˜ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: Rustã®ã‚¼ãƒ­ã‚³ã‚¹ãƒˆæŠ½è±¡åŒ–
2. **å‹å®‰å…¨æ€§**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã‚¨ãƒ©ãƒ¼æ¤œå‡º
3. **ãƒ¡ãƒ¢ãƒªå®‰å…¨æ€§**: ãƒã‚°ã®å¤§å¹…å‰Šæ¸›
4. **ä¸¦è¡Œå‡¦ç†**: å®‰å…¨ãªéåŒæœŸå‡¦ç†

### **é–‹ç™ºåŠ¹ç‡**
1. **çµ±ä¸€ã•ã‚ŒãŸè¨€èª**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ»WASM
2. **å‹å…±æœ‰**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–“
3. **ã‚¨ãƒ©ãƒ¼å‡¦ç†**: åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
4. **ãƒ†ã‚¹ãƒˆ**: åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆæˆ¦ç•¥

## ğŸ“š **å‚è€ƒè³‡æ–™**

### **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ**
- `doc/architecture/rust_backend_architecture.md` - Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è¨­è¨ˆ
- `doc/architecture/architecture_diff.md` - å¤‰æ›´å·®åˆ†

### **æŠ€è¡“é¸å®š**
- `doc/adr/` - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ±ºå®šè¨˜éŒ²ï¼ˆADRï¼‰

### **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç”»**
- `doc/loadmap/migration-plan.md` - æ›´æ–°æ¸ˆã¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç”»

---

## ğŸš€ **æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**

1. **Rustãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ**
2. **Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯é¸å®šãƒ»è¨­å®š**
3. **ORMè¨­å®šï¼ˆDiesel/SeaORMï¼‰**
4. **åŸºæœ¬çš„ãªAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…**

ã“ã®ç§»è¡Œã«ã‚ˆã‚Šã€**æœ€é«˜ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**ã¨**é–‹ç™ºåŠ¹ç‡**ã‚’ä¸¡ç«‹ã—ãŸãƒ¢ãƒ€ãƒ³ãªãƒ†ãƒˆãƒªã‚¹ã‚²ãƒ¼ãƒ ãŒå®Œæˆã—ã¾ã™ã€‚ 